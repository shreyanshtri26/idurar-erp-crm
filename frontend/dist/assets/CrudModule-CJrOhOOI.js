import{b7 as H,aU as F,a as u,aT as e}from"./index--J6gaKqH.js";import{s as k,C as O,a as v,D as P,b as R,c as w,R as A,S as N}from"./index-DV57aTJh.js";import{d as p}from"./index-BcAYd26p.js";import{c as d}from"./actions-Bt69AeFc.js";import{u as E}from"./index-sTiArh6c.js";import{V as B,ae as S,ai as Z,O as f,ac as I,aa as x,a8 as z}from"./erpOs-CMKQyu82.js";import{P as U}from"./PlusOutlined-D3iknlFd.js";import{D as _}from"./DeleteOutlined-DpfJlTkJ.js";function q({config:s,formElements:o,withUpload:n=!1}){let{entity:a}=s;const r=B(),m=H(),{current:c,isLoading:C,isSuccess:j}=F(k),{state:D,crudContextAction:Y}=E(),{panel:i,collapsedBox:h,readBox:y}=Y,b=()=>{y.open()},[l]=S.useForm(),T=t=>{const L=c._id;t.file&&n&&(t.file=t.file[0].originFileObj),m(d.update({entity:a,id:L,jsonData:t,withUpload:n}))};u.useEffect(()=>{if(c){let t={...c};t.birthday&&(t={...t,birthday:p(t.birthday).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),t.date&&(t={...t,date:p(t.date).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),t.expiredDate&&(t={...t,expiredDate:p(t.expiredDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),t.created&&(t={...t,created:p(t.created).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),t.updated&&(t={...t,updated:p(t.updated).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),l.resetFields(),l.setFieldsValue(t)}},[c]),u.useEffect(()=>{j&&(y.open(),h.open(),i.open(),l.resetFields(),m(d.resetAction({actionType:"update"})),m(d.list({entity:a})))},[j]);const{isEditBoxOpen:g}=D,M=g?{display:"block",opacity:1}:{display:"none",opacity:0};return e.jsx("div",{style:M,children:e.jsx(Z,{isLoading:C,children:e.jsxs(S,{form:l,layout:"vertical",onFinish:T,children:[o,e.jsx(S.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(f,{type:"primary",htmlType:"submit",children:r("Save")})}),e.jsx(S.Item,{style:{display:"inline-block",paddingLeft:"5px"},children:e.jsx(f,{onClick:b,children:r("Cancel")})})]})})})}function G({config:s,formElements:o,withUpload:n}){const a=B(),{crudContextAction:r,state:m}=E(),{deleteModalLabels:c}=s,{modal:C,editBox:j}=r,{isReadBoxOpen:D,isEditBoxOpen:Y}=m,{result:i}=F(w),h=H(),[y,b]=u.useState("");u.useEffect(()=>{if(i){const M=c.map(t=>i[t]).join(" ");b(M)}},[i]);const l=()=>{h(d.currentAction({actionType:"delete",data:i})),C.open()},T=()=>{h(d.currentAction({actionType:"update",data:i})),j.open()},g=D||Y?{opacity:1}:{opacity:0};return e.jsxs(e.Fragment,{children:[e.jsxs(I,{style:g,gutter:24,children:[e.jsx(x,{span:10,children:e.jsx("p",{style:{marginBottom:"10px"},children:y})}),e.jsxs(x,{span:14,children:[e.jsx(f,{onClick:l,type:"text",icon:e.jsx(_,{}),size:"small",style:{float:"right",marginLeft:"5px",marginTop:"10px"},children:a("remove")}),e.jsx(f,{onClick:T,type:"text",icon:e.jsx(z,{}),size:"small",style:{float:"right",marginLeft:"0px",marginTop:"10px"},children:a("edit")})]}),e.jsx(x,{span:24,children:e.jsx("div",{className:"line"})}),e.jsx("div",{className:"space10"})]}),e.jsx(A,{config:s}),e.jsx(q,{config:s,formElements:o,withUpload:n})]})}function J({config:s}){const{crudContextAction:o}=E(),{collapsedBox:n}=o,a=()=>{n.close()};return e.jsxs(I,{gutter:8,children:[e.jsx(x,{className:"gutter-row",span:21,children:e.jsx(N,{config:s})}),e.jsx(x,{className:"gutter-row",span:3,children:e.jsx(f,{onClick:a,block:!0,icon:e.jsx(U,{})})})]})}function se({config:s,createForm:o,updateForm:n,withUpload:a=!1}){const r=H();return u.useLayoutEffect(()=>{r(d.resetState())},[]),e.jsxs(O,{config:s,fixHeaderPanel:e.jsx(J,{config:s}),sidePanelBottomContent:e.jsx(v,{config:s,formElements:o,withUpload:a}),sidePanelTopContent:e.jsx(G,{config:s,formElements:n,withUpload:a}),children:[e.jsx(P,{config:s}),e.jsx(R,{config:s})]})}export{se as C};
