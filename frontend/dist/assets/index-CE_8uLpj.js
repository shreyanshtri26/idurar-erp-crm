import{a as y,h as q,aT as e,b7 as S,aU as _}from"./index--J6gaKqH.js";import{A as z,V as b,ae as r,af as I,$ as f,al as L,C as M,ai as N,O as x,ad as Z,Z as V,M as $,a8 as W,am as G,ac as F,aa as P}from"./erpOs-CMKQyu82.js";import{s as H,D as J,C as K,a as Q,b as X,c as ee,R as te,S as ae}from"./index-DV57aTJh.js";import{d as w}from"./index-BcAYd26p.js";import{c as h}from"./actions-Bt69AeFc.js";import{u as T}from"./index-sTiArh6c.js";import{S as U}from"./countryList-BECIveE_.js";import{D as se}from"./DeleteOutlined-DpfJlTkJ.js";import{P as ne}from"./PlusOutlined-D3iknlFd.js";import{T as re}from"./index-BXLypoqc.js";import"./helpers-B3L87vXg.js";import"./index-CEBP3NLi.js";import"./ErpApp-BEAjmWaO.js";import"./fade-B7XK0E1_.js";import"./useDate-BUBJ-65Y.js";import"./currency.es-9OAR_aOO.js";import"./useDebounce-CK9jXVuP.js";import"./index-KrFx5yLV.js";import"./color-DHucoY0N.js";import"./ArrowRightOutlined-BulyMten.js";import"./Table-BPtJoJS3.js";var oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464H332V240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v68c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-68c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zm-40 376H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"unlock",theme:"outlined"};const le=oe;var ie=function(n,a){return y.createElement(z,q({},n,{ref:a,icon:le}))},de=y.forwardRef(ie);const ce=de;function B({isUpdateForm:t=!1,isForAdminOwner:n=!1}){const a=b();return e.jsxs(e.Fragment,{children:[e.jsx(r.Item,{label:a("first Name"),name:"name",rules:[{required:!0}],children:e.jsx(I,{autoComplete:"off"})}),e.jsx(r.Item,{label:a("last Name"),name:"surname",rules:[{required:!0}],children:e.jsx(I,{autoComplete:"off"})}),e.jsx(r.Item,{label:a("email"),name:"email",rules:[{required:!0},{type:"email"}],children:e.jsx(I,{autoComplete:"off"})}),!t&&e.jsx(r.Item,{label:a("Password"),name:"password",rules:[{required:!0}],children:e.jsx(I.Password,{autoComplete:"new-password"})}),e.jsx(r.Item,{label:a("Role"),name:"role",rules:[{required:!0}],children:e.jsxs(f,{children:[e.jsx(f.Option,{value:"owner",disabled:!n,children:a("Account owner")}),e.jsx(f.Option,{value:"admin",disabled:n,children:a("super_admin")}),e.jsx(f.Option,{value:"manager",disabled:n,children:a("manager")}),e.jsx(f.Option,{value:"employee",disabled:n,children:a("employee")}),e.jsx(f.Option,{value:"create_only",disabled:n,children:a("create_only")}),e.jsx(f.Option,{value:"read_only",disabled:n,children:a("read_only")})]})}),e.jsx(r.Item,{label:a("enabled"),name:"enabled",valuePropName:"checked",initialValue:!0,children:e.jsx(U,{checkedChildren:e.jsx(L,{}),unCheckedChildren:e.jsx(M,{})})})]})}function me({config:t,formElements:n,withUpload:a=!1}){let{entity:o}=t;const m=b(),d=S(),{current:l,isLoading:u,isSuccess:c}=_(H),{state:i,crudContextAction:p}=T(),{panel:j,collapsedBox:g,readBox:v}=p,k=()=>{v.open()},[E,D]=y.useState(!1),[C]=r.useForm(),O=s=>{const A=l._id;s.file&&a&&(s.file=s.file[0].originFileObj),d(h.update({entity:o,id:A,jsonData:s,withUpload:a}))};y.useEffect(()=>{if(l){let s={...l};s.birthday&&(s={...s,birthday:w(s.birthday).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),s.date&&(s={...s,date:w(s.date).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),s.expiredDate&&(s={...s,expiredDate:w(s.expiredDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),s.created&&(s={...s,created:w(s.created).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),s.updated&&(s={...s,updated:w(s.updated).format("YYYY-MM-DDTHH:mm:ss.SSSZ")});const A=l.role==="owner";D(A),C.resetFields(),C.setFieldsValue(s)}},[l]),y.useEffect(()=>{c&&(v.open(),g.open(),j.open(),C.resetFields(),d(h.resetAction({actionType:"update"})),d(h.list({entity:o})))},[c]);const{isEditBoxOpen:Y}=i,R=Y?{display:"block",opacity:1}:{display:"none",opacity:0};return e.jsx("div",{style:R,children:e.jsx(N,{isLoading:u,children:e.jsxs(r,{form:C,layout:"vertical",onFinish:O,children:[e.jsx(B,{isUpdateForm:!0,isForAdminOwner:E}),e.jsx(r.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(x,{type:"primary",htmlType:"submit",children:m("Save")})}),e.jsx(r.Item,{style:{display:"inline-block",paddingLeft:"5px"},children:e.jsx(x,{onClick:k,children:m("Cancel")})})]})})})}function ue({config:t}){const n=b();return e.jsx(J,{config:t,extra:[{label:n("Update Password"),key:"updatePassword",icon:e.jsx(ce,{})}]})}function pe({config:t}){const n=b(),a=S(),{current:o}=_(H),{state:m,crudContextAction:d}=T(),[l]=r.useForm(),{onFetch:u,result:c,isLoading:i,isSuccess:p}=Z(),j=D=>{const C="admin/password-update/"+o._id,Y=(async()=>await V.patch({entity:C,jsonData:D}))();u(Y)},{readBox:g}=d,v=()=>{g.open()};y.useEffect(()=>{p&&(l.resetFields(),a(h.resetAction({actionType:"update"})))},[p]);const{isAdvancedBoxOpen:k}=m,E=k?{display:"block",opacity:1}:{display:"none",opacity:0};return e.jsx("div",{style:E,children:e.jsxs(N,{isLoading:i,children:[e.jsx("h3",{children:n("Update Password")}),e.jsx("div",{className:"space10"}),e.jsxs(r,{form:l,layout:"vertical",onFinish:j,children:[e.jsx(r.Item,{label:n("New Password"),name:"password",rules:[{required:!0}],children:e.jsx(I.Password,{autoComplete:"new-password"})}),e.jsx(r.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(x,{type:"primary",htmlType:"submit",children:n("Save")})}),e.jsx(r.Item,{style:{display:"inline-block",paddingLeft:"5px"},children:e.jsx(x,{onClick:v,children:n("Cancel")})})]})]})})}function xe({config:t,formElements:n}){const a=b(),{crudContextAction:o}=T(),{advancedBox:m,modal:d,editBox:l}=o,{result:u}=_(ee),c=S(),i=()=>{c(h.currentAction({actionType:"delete",data:u})),d.open()},p=()=>{c(h.currentAction({actionType:"update",data:u})),l.open()},j=()=>{c(h.currentAction({actionType:"update",data:u})),m.open()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space20"}),e.jsxs($,{children:[e.jsx(x,{onClick:i,type:"text",icon:e.jsx(se,{}),size:"small",children:a("remove")}),e.jsx(x,{onClick:p,type:"text",icon:e.jsx(W,{}),size:"small",children:a("edit")}),e.jsx(x,{onClick:j,type:"text",icon:e.jsx(G,{}),size:"small",children:a("Update Password")})]}),e.jsx("div",{className:"space20"}),e.jsx(te,{config:t}),e.jsx(me,{config:t,formElements:n,withUpload:!0}),e.jsx(pe,{config:t})]})}function he({config:t}){const{crudContextAction:n}=T(),{collapsedBox:a}=n,o=()=>{a.close()};return e.jsxs(e.Fragment,{children:[e.jsx(F,{gutter:12,children:e.jsx(P,{className:"gutter-row",span:24,children:e.jsx("h1",{style:{fontSize:20,marginBottom:20},children:t.PANEL_TITLE})})}),e.jsxs(F,{gutter:8,children:[e.jsx(P,{className:"gutter-row",span:21,children:e.jsx(ae,{config:t})}),e.jsx(P,{className:"gutter-row",span:3,children:e.jsx(x,{onClick:o,block:!0,icon:e.jsx(ne,{})})})]})]})}function je({config:t,createForm:n,updateForm:a}){const o=S();return y.useLayoutEffect(()=>{o(h.resetState())},[]),e.jsxs(K,{config:t,fixHeaderPanel:e.jsx(he,{config:t}),sidePanelBottomContent:e.jsx(Q,{config:t,formElements:n,withUpload:!1}),sidePanelTopContent:e.jsx(xe,{config:t,formElements:a}),children:[e.jsx(ue,{config:t}),e.jsx(X,{config:t})]})}const fe={owner:"gold",admin:"magenta",manager:"purple",employee:"blue",create_only:"green",read_only:null};function He(){const t=b(),n="admin",a={displayLabels:["name","surname"],searchFields:"email,name,surname",outputValue:"_id"},o=["email"],m=[{title:t("first name"),dataIndex:"name"},{title:t("last name"),dataIndex:"surname"},{title:t("Email"),dataIndex:"email"},{title:t("role"),dataIndex:"role"}],d=[{title:t("first name"),dataIndex:"name"},{title:t("last name"),dataIndex:"surname"},{title:t("Email"),dataIndex:"email"},{title:t("role"),dataIndex:"role",render:(i,p)=>{const j=i==="owner"?"Account owner":i==="admin"?"super admin":i;return e.jsx(re,{color:fe[i],children:t(j)})}},{title:t("enabled"),dataIndex:"enabled",onCell:()=>({props:{style:{width:"60px"}}}),render:(i,p)=>e.jsx(U,{checked:i,checkedChildren:e.jsx(L,{}),unCheckedChildren:e.jsx(M,{})})}],l={PANEL_TITLE:t("admin"),DATATABLE_TITLE:t("admin_list"),ADD_NEW_ENTITY:t("add_new_admin"),ENTITY_NAME:t("admin"),RECORD_ENTITY:t("record_payment")},c={...{entity:n,...l},readColumns:m,dataTableColumns:d,searchConfig:a,deleteModalLabels:o};return e.jsx(je,{createForm:e.jsx(B,{}),config:c})}export{He as default};
