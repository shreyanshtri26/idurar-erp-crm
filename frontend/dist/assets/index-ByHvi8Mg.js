import{aU as O,aT as e,b8 as I,b7 as T,a as h}from"./index--J6gaKqH.js";import{P as B}from"./index-BcAYd26p.js";import{A as F}from"./index-BZxXnXFt.js";import{V as N,a7 as z,a8 as U,X as W,O as R,a9 as q}from"./erpOs-CMKQyu82.js";import{e as l}from"./actions-DqrCK4Yp.js";import{e as H,f as K}from"./selectors-APkanmoC.js";import{a as C}from"./index-sTiArh6c.js";import{s as L}from"./index-KrFx5yLV.js";import{D as V,E as X}from"./ErpApp-BEAjmWaO.js";import{T as Y}from"./Table-BPtJoJS3.js";import{F as G}from"./FilePdfOutlined-dEavOBWy.js";import{D as J}from"./DeleteOutlined-DpfJlTkJ.js";import{A as Q,a as Z}from"./ArrowRightOutlined-BulyMten.js";import{R as ee,a as te}from"./helpers-B3L87vXg.js";import{P as se}from"./PlusOutlined-D3iknlFd.js";import{M as ne}from"./index-CEBP3NLi.js";function ae({config:i}){const c=I(),{ADD_NEW_ENTITY:a,entity:s}=i,r=()=>{c(`/${s.toLowerCase()}/create`)};return e.jsx(R,{onClick:r,type:"primary",icon:e.jsx(se,{}),children:a})}function oe({config:i,extra:c=[]}){const a=N();let{entity:s,dataTableColumns:r,disableAdd:m=!1,searchConfig:n}=i;const{DATATABLE_TITLE:x}=i,{result:y,isLoading:b}=O(H),{pagination:g,items:j}=y,{erpContextAction:u}=C(),{modal:D}=u,k=[{label:a("Show"),key:"read",icon:e.jsx(z,{})},{label:a("Edit"),key:"edit",icon:e.jsx(U,{})},{label:a("Download"),key:"download",icon:e.jsx(G,{})},...c,{type:"divider"},{label:a("Delete"),key:"delete",icon:e.jsx(J,{})}],f=I(),A=t=>{p(l.currentItem({data:t})),f(`/${s}/read/${t._id}`)},d=t=>{const o={...t};p(l.currentAction({actionType:"update",data:o})),f(`/${s}/update/${t._id}`)},w=t=>{window.open(`${q}${s}/${s}-${t._id}.pdf`,"_blank")},S=t=>{p(l.currentAction({actionType:"delete",data:t})),D.open()},v=t=>{p(l.currentItem({data:t})),f(`/invoice/pay/${t._id}`)};r=[...r,{title:"",key:"action",fixed:"right",render:(t,o)=>e.jsx(V,{menu:{items:k,onClick:({key:E})=>{switch(E){case"read":A(o);break;case"edit":d(o);break;case"download":w(o);break;case"delete":S(o);break;case"recordPayment":v(o);break}}},trigger:["click"],children:e.jsx(X,{style:{cursor:"pointer",fontSize:"24px"},onClick:E=>E.preventDefault()})})}];const p=T(),_=t=>{const o={page:t.current||1,items:t.pageSize||10};p(l.list({entity:s,options:o}))},P=()=>{p(l.list({entity:s}))};h.useEffect(()=>{const t=new AbortController;return P(),()=>{t.abort()}},[]);const M=t=>{const o={equal:t,filter:n==null?void 0:n.entity};p(l.list({entity:s,options:o}))},$=O(W);return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:x,ghost:!0,onBack:()=>window.history.back(),backIcon:$==="rtl"?e.jsx(Q,{}):e.jsx(Z,{}),extra:[e.jsx(F,{entity:n==null?void 0:n.entity,displayLabels:["name"],searchFields:"name",onChange:M},`${L.generate()}`),e.jsx(R,{onClick:_,icon:e.jsx(ee,{}),children:a("Refresh")},`${L.generate()}`),!m&&e.jsx(ae,{config:i},`${L.generate()}`)],style:{padding:"20px 0px",direction:$}}),e.jsx(Y,{columns:r,rowKey:t=>t._id,dataSource:j,pagination:g,loading:b,onChange:_,scroll:{x:!0}})]})}function ie({config:i}){let{entity:c,deleteModalLabels:a,deleteMessage:s="Do you want delete : ",modalTitle:r="Remove Item"}=i;const m=T(),{current:n,isLoading:x,isSuccess:y}=O(K),{state:b,erpContextAction:g}=C(),{deleteModal:j}=b,{modal:u}=g,[D,k]=h.useState("");h.useEffect(()=>{if(y){u.close();const d={page:1,items:10};m(l.list({entity:c,options:d}))}if(n){let d=a.map(w=>te(n,w)).join(" ");k(d)}},[y,n]);const f=()=>{const d=n._id;m(l.delete({entity:c,id:d})),u.close()},A=()=>{x||u.close()};return e.jsx(ne,{title:r,open:j.isOpen,onOk:f,onCancel:A,confirmLoading:x,children:e.jsxs("p",{children:[s,D]})})}function Ae({config:i,extra:c}){const a=T(),{state:s}=C(),{deleteModal:r}=s,m=()=>{a(l.resetState())};return h.useLayoutEffect(()=>{const n=new AbortController;return m(),()=>{n.abort()}},[]),e.jsxs(e.Fragment,{children:[e.jsx(oe,{config:i,extra:c}),e.jsx(ie,{config:i,isOpen:r.isOpen})]})}export{Ae as E};
